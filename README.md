# pptx-glimpse

PPTX スライドを SVG / PNG に変換する TypeScript ライブラリ。

## インストール

```bash
npm install pptx-glimpse
```

## 使い方

```typescript
import { readFileSync } from "fs";
import { convertPptxToSvg, convertPptxToPng } from "pptx-glimpse";

const pptx = readFileSync("presentation.pptx");

// SVG に変換
const svgResults = await convertPptxToSvg(pptx);
// [{ slideNumber: 1, svg: "<svg>...</svg>" }, ...]

// PNG に変換
const pngResults = await convertPptxToPng(pptx);
// [{ slideNumber: 1, png: Buffer, width: 960, height: 540 }, ...]
```

## サポート状況

PowerPoint の静的なビジュアルコンテンツの変換に対応しています。アニメーションやトランジションなど、動的な要素には対応していません。

### 対応している機能

#### 図形

| 機能           | 詳細                                                                      |
| -------------- | ------------------------------------------------------------------------- |
| プリセット図形 | 113 種類 (矩形、楕円、矢印、フローチャート、吹き出し、星形、数学記号など) |
| カスタム図形   | カスタムパス (moveTo, lnTo, cubicBezTo, close) による任意の図形描画       |
| コネクター     | 線コネクターの描画、線スタイル・色・太さの設定                            |
| グループ       | 図形のグループ化、ネストされたグループ                                    |
| 変形           | 位置、サイズ、回転、反転 (flipH/flipV)、調整値                            |

#### テキスト

| 機能             | 詳細                                                                                                            |
| ---------------- | --------------------------------------------------------------------------------------------------------------- |
| 文字書式         | フォントサイズ、フォントファミリー (東アジアフォント対応)、太字、斜体、下線、取り消し線、文字色、上付き・下付き |
| 段落書式         | 水平配置 (left/center/right/justify)、垂直アンカー (top/center/bottom)、行間、段落前後スペース、インデント      |
| 箇条書き         | 文字箇条書き (buChar)、自動番号 (buAutoNum、9 種類)、箇条書きフォント・色・サイズ                               |
| テキストボックス | 折り返し (square/none)、自動調整 (noAutofit/normAutofit/spAutofit)、フォントスケール、マージン                  |
| 単語折り返し     | 英語・日本語・CJK テキストの折り返し、複数フォントサイズ混在時の折り返し                                        |

#### 塗りつぶし

| 機能           | 詳細                                                     |
| -------------- | -------------------------------------------------------- |
| ソリッドカラー | RGB 色指定、透明度                                       |
| グラデーション | 線形グラデーション、複数グラデーションストップ、角度指定 |
| 画像塗りつぶし | PNG/JPEG/GIF、引き伸ばし (stretch) モード                |
| 塗りつぶしなし | noFill 指定                                              |

#### 線・枠線

| 機能         | 詳細                                                          |
| ------------ | ------------------------------------------------------------- |
| 線スタイル   | 線幅、ソリッドカラー、透明度                                  |
| 破線スタイル | solid, dash, dot, dashDot, lgDash, lgDashDot, sysDash, sysDot |

#### 色

| 機能         | 詳細                                                                          |
| ------------ | ----------------------------------------------------------------------------- |
| 色指定方式   | RGB (srgbClr)、テーマ色 (schemeClr)、システム色 (sysClr)                      |
| テーマカラー | カラースキーム (dk1, lt1, dk2, lt2, accent1-6, hlink, folHlink)、カラーマップ |
| 色変換       | 輝度調整 (lumMod/lumOff)、ティント (tint)、シェード (shade)、透明度 (alpha)   |

#### エフェクト

| 機能               | 詳細                               |
| ------------------ | ---------------------------------- |
| 外側の影           | ぼかし半径、距離、方向、色・透明度 |
| 内側の影           | ぼかし半径、距離、方向、色・透明度 |
| 光彩               | 半径、色・透明度                   |
| ぼかし (Soft Edge) | 半径                               |

#### 画像

| 機能           | 詳細                                               |
| -------------- | -------------------------------------------------- |
| 画像要素       | PNG/JPEG/GIF、位置・サイズ・回転・反転、エフェクト |
| 画像塗りつぶし | 図形・背景への画像塗りつぶし                       |

#### 表

| 機能         | 詳細                                                                   |
| ------------ | ---------------------------------------------------------------------- |
| テーブル構造 | 行・列のグリッド、セル結合 (gridSpan/rowSpan)、行の高さ・列の幅        |
| セルの書式   | テキスト、塗りつぶし (solid/gradient/image)、枠線 (上下左右、スタイル) |

#### グラフ

| 機能       | 詳細                                                                       |
| ---------- | -------------------------------------------------------------------------- |
| 対応グラフ | 棒グラフ (縦棒・横棒)、折れ線グラフ、円グラフ、散布図                      |
| グラフ要素 | タイトル、凡例 (位置指定)、系列 (名前・値・カテゴリ・色)、カテゴリ軸、値軸 |

#### 背景・スライド設定

| 機能           | 詳細                                                                                 |
| -------------- | ------------------------------------------------------------------------------------ |
| 背景           | ソリッド、グラデーション、画像。スライド → レイアウト → マスターの順でフォールバック |
| スライドサイズ | 16:9、4:3、カスタムサイズ                                                            |
| テーマ         | テーマカラースキーム、テーマフォント (majorFont/minorFont)                           |

### 対応していない機能

| カテゴリ         | 未対応の機能                                                                                                                     |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| 塗りつぶし       | パターン塗りつぶし、放射状グラデーション、パスグラデーション                                                                     |
| エフェクト       | 反射、3D 回転・押し出し、アーティスティック効果                                                                                  |
| グラフ           | 面グラフ、レーダー、ドーナツ、バブル、株価、複合、ヒストグラム、ボックスプロット、ウォーターフォール、ツリーマップ、サンバースト |
| グラフの詳細機能 | データラベル、軸タイトル・目盛り・グリッド線、誤差範囲、トレンドライン                                                           |
| テキスト         | 縦書きテキスト、テキスト個別のエフェクト (影・光彩)、テキストのアウトライン、テキストの列                                        |
| 表               | 表スタイルのテンプレート適用、対角線枠線                                                                                         |
| 図形             | 図形の結合 (Union/Subtract/Intersect/Fragment)                                                                                   |
| SmartArt         | SmartArt 全般                                                                                                                    |
| マルチメディア   | 動画・音声の埋め込み                                                                                                             |
| アニメーション   | オブジェクトアニメーション、スライドトランジション                                                                               |
| リンク           | ハイパーリンク                                                                                                                   |
| スライド要素     | スライドノート、コメント、ヘッダー・フッター、スライド番号・日付                                                                 |
| 画像フォーマット | EMF/WMF (パースされるがレンダリング未対応)                                                                                       |
| その他           | マクロ・VBA、セクション、ズームスライド                                                                                          |

## テストレンダリング

PPTX ファイルを指定して、SVG と PNG の変換結果を確認できます。

```bash
npm run render -- <pptx-file> [output-dir]
```

- `output-dir` を省略すると `./output` に出力されます

```bash
# 例
npm run render -- presentation.pptx
npm run render -- presentation.pptx ./my-output
```

## ライセンス

MIT
